# IVI負荷アプリ ユースケース仕様書 (Use Case Specification)

## 1. ユースケース一覧 (Use Case List)

| ID    | ユースケース名                               | アクター             | 概要                                                           |
|-------|----------------------------------------------|----------------------|----------------------------------------------------------------|
| UC-01 | ユーザーによるCPU負荷の手動調整              | ユーザー             | ユーザーが画面操作でCPU負荷率を調整する。                      |
| UC-02 | ユーザーによるGPU負荷の手動調整              | ユーザー             | ユーザーが画面操作でGPU負荷率を調整する。                      |
| UC-03 | 外部システムによるCPU負荷の遠隔調整          | 外部PC               | 外部PCがIPC通信を介してCPU負荷率を指示する。                   |
| UC-04 | 外部システムによるGPU負荷の遠隔調整          | 外部PC               | 外部PCがIPC通信を介してGPU負荷率を指示する。                   |
| UC-05 | AIアプリからのUI更新指示             | AIアプリ     | AIアプリがIPC通信を介してUIの表示内容を指示する。      |

---

## 2. ユースケース詳細 (Use Case Details)

### UC-01: ユーザーによるCPU負荷の手動調整

- **アクター:** ユーザー
- **事前条件:** IVI負荷アプリが起動しており、ホーム画面が表示されている。
- **事後条件:** 
  - システムのCPU負荷がユーザーの指定した値に応じて変更される。
  - 画面上のCPU負荷率表示が更新される。
- **基本フロー:**
  1. ユーザーが画面上のCPU負荷コントロールUIの「+10%」「+1%」「-1%」「-10%」のいずれかのボタンを押下する。
  2. システム（`CpuLoadController`）がボタン押下イベントを検知し、`StateManagement`に通知する。
  3. `StateManagement`が現在のCPU負荷率を更新する。
  4. `StateManagement`がUIに変更を通知する。
  5. CPU負荷コントロールUIの表示が新しい負荷率に更新される。
  6. `StateManagement`が`CpuLoadGenerator`に新しい負荷率を指示する。
  7. `CpuLoadGenerator`が新しい負荷率に基づいてCPU上で計算タスクを実行し、負荷を生成する。
- **代替フロー (4a. 負荷率が上限・下限に達した場合):**
  1. ユーザーが負荷を100%以上に、または0%以下にしようとするボタンを押下する。
  2. `StateManagement`は負荷率をそれぞれ100%または0%に維持し、それ以上変更しない。

### UC-02: ユーザーによるGPU負荷の手動調整

- **アクター:** ユーザー
- **事前条件:** IVI負荷アプリが起動しており、ホーム画面が表示されている。
- **事後条件:**
  - システムのGPU負荷がユーザーの指定した値に応じて変更される。
  - 画面上のGPU負荷率表示が更新される。
- **基本フロー:**
  1. ユーザーが画面上のGPU負荷コントロールUIの「+10%」「+1%」「-1%」「-10%」のいずれかのボタンを押下する。
  2. (UC-01と同様のフロー)
  ...
  7. `GpuLoadGenerator`が新しい負荷率に基づいてGPU上で描画タスクを実行し、負荷を生成する。
- **代替フロー:** (UC-01と同様)

### UC-03: 外部システムによるCPU負荷の遠隔調整

- **アクター:** 外部PC
- **事前条件:** IVI負荷アプリが起動しており、IPCリスナーが待機中である。
- **事後条件:**
  - システムのCPU負荷が外部PCの指定した値に応じて変更される。
  - 画面上のCPU負荷率表示が更新される。
- **基本フロー:**
  1. 外部PCがCPU負荷率を指定するIPCメッセージを送信する。(例: `"cpu_load: 50"`)
  2. システム（`IpcReceiver`）がメッセージを受信する。
  3. `IpcReceiver`がメッセージを`StateManagement`に転送する。
  4. `StateManagement`がメッセージを解析し、CPU負荷率を更新する。
  5. (UC-01のフロー4-7と同様)
- **代替フロー:**
  - **4a. 不正なメッセージを受信した場合:** `StateManagement`はメッセージを無視し、ログを記録する。

### UC-04: 外部システムによるGPU負荷の遠隔調整

- **アクター:** 外部PC
- **事前条件:** IVI負荷アプリが起動しており、IPCリスナーが待機中である。
- **事後条件:**
  - システムのGPU負荷が外部PCの指定した値に応じて変更される。
  - 画面上のGPU負荷率表示が更新される。
- **基本フロー:**
  1. 外部PCがGPU負荷率を指定するIPCメッセージを送信する。(例: `"gpu_load: 70"`)
  2. (UC-03と同様のフロー)
  ...
- **代替フロー:** (UC-03と同様)

### UC-05: AIアプリからのUI更新指示

- **アクター:** AIアプリ
- **事前条件:** IVI負荷アプリが起動しており、IPCリスナーが待機中である。
- **事後条件:** IVI負荷アプリの`AiAppView`の表示内容が指示に応じて更新される。
- **基本フロー:**
  1. AIアプリがUI表示内容を指示するIPCメッセージを送信する。(例: `"show_icon: hand"`)
  2. システム（`IpcReceiver`）がメッセージを受信する。
  3. `IpcReceiver`がメッセージを`StateManagement`に転送する。
  4. `StateManagement`がメッセージを解析し、関連するUIの状態（例: `handIconVisible = true`）を更新する。
  5. `StateManagement`がUI(`AiAppView`)に変更を通知する。
  6. `AiAppView`が`StateManagement`から新しい状態を取得し、表示を更新する（例: 手のアイコンを表示する）。
- **代替フロー:**
  - **4a. 不正なメッセージを受信した場合:** `StateManagement`はメッセージを無視し、ログを記録する。
